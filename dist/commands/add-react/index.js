"use strict";var _interopRequireDefault=require("@babel/runtime/helpers/interopRequireDefault");require("core-js/modules/es.array.iterator"),Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=exports.addReact=void 0;var _asyncToGenerator2=_interopRequireDefault(require("@babel/runtime/helpers/asyncToGenerator")),_path=require("path"),_api=require("../../api");const REACT_DEPENDENCIES=["prop-types","react","react-dom","wouter",// https://github.com/molefrog/wouter
"@hot-loader/react-dom"],DEV_DEPENDENCIES=["npm-run-all"],ALWAYS=()=>!0,addReact=[{text:"Copy React boilerplate and assets",task:function(){var _ref=(0,_asyncToGenerator2.default)(function*({assetsDirectory,sourceDirectory,overwrite,useParcel}){const index=useParcel?"index-in-place-react.html":"index-react.html",fonts=useParcel?"fonts-in-place.css":"fonts.css";yield new _api.Scaffolder((0,_path.join)(__dirname,"templates")).overwrite(overwrite).target(sourceDirectory).copy("main.js","main.jsx").target(`${sourceDirectory}/components`).copy("App.js","App.jsx").copy("Header.js","Header.jsx").copy("Body.js","Body.jsx").copy("Footer.js","Footer.jsx").commit(),yield new _api.Scaffolder((0,_path.join)(__dirname,"..","common","templates")).overwrite(overwrite).target(".").copy("gitignore",".gitignore").target(`${assetsDirectory}`).copy(index,"index.html").target(`${assetsDirectory}/css`).copy("style.css").copy(fonts,"fonts.css").target(`${assetsDirectory}/images`).copy("react.png").copy("preferences.png").target(`${assetsDirectory}/fonts`).copy("SansForgetica-Regular.eot").copy("SansForgetica-Regular.svg").copy("SansForgetica-Regular.ttf").copy("SansForgetica-Regular.woff").copy("SansForgetica-Regular.woff2").target(`${assetsDirectory}/library`).copy(".gitkeep").target(`${assetsDirectory}/workers`).copy(".gitkeep").commit()});return function task(){return _ref.apply(this,arguments)}}(),condition:ALWAYS},{text:"Copy Rust boilerplate",task:function(){var _ref2=(0,_asyncToGenerator2.default)(function*({overwrite}){yield new _api.Scaffolder((0,_path.join)(__dirname,"..","common","templates")).overwrite(overwrite).target(".").copy("Cargo.toml").target("rust-to-wasm").copy("Cargo_crate.toml","Cargo.toml").target("rust-to-wasm/src").copy("lib.rs").copy("utils.rs").target("rust-to-wasm/tests").copy("app.rs").copy("web.rs").commit()});return function task(){return _ref2.apply(this,arguments)}}(),condition:({withRust})=>withRust,optional:({withRust})=>withRust},{text:"Set package.json \"main\" attribute and add scripts tasks",task:function(){var _ref3=(0,_asyncToGenerator2.default)(function*({sourceDirectory,useParcel,useRollup}){const scripts={"watch:es":useRollup?`watch \"npm run build:es\" ${sourceDirectory}`:"webpack-dev-server --hot --open --mode development",start:"npm-run-all build:es --parallel watch:*"};yield new _api.PackageJsonEditor().extend({main:`${sourceDirectory}/main.js`}).extend(useParcel?{}:{scripts}).commit()});return function task(){return _ref3.apply(this,arguments)}}(),condition:()=>(0,_api.allDoExist)("package.json")},{text:"Install React dependencies",task:({skipInstall})=>(0,_api.install)([...REACT_DEPENDENCIES,...DEV_DEPENDENCIES],{skipInstall}),condition:({isNotOffline,skipInstall})=>!skipInstall&&isNotOffline&&(0,_api.allDoExist)("package.json")}];exports.addReact=addReact;var _default=addReact;exports.default=_default;