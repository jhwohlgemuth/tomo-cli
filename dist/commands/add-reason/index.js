"use strict";var _interopRequireDefault=require("@babel/runtime/helpers/interopRequireDefault");require("core-js/modules/es.array.iterator"),Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=exports.removeReason=exports.addReason=void 0;var _asyncToGenerator2=_interopRequireDefault(require("@babel/runtime/helpers/asyncToGenerator")),_path=require("path"),_api=require("../../api");const DEPENDENCIES=["reason-react"],DEV_DEPENDENCIES=["bs-platform"],addReason=[{text:"Create bsconfig.json file",task:function(){var _ref=(0,_asyncToGenerator2.default)(function*(){const{name}=new _api.PackageJsonEditor().read();yield new _api.BsConfigJsonEditor().create().extend({name}).commit()});return function task(){return _ref.apply(this,arguments)}}(),condition:()=>(0,_api.allDoNotExist)("bsconfig.json")},{text:"Add Reason scripts to package.json",task:function(){var _ref2=(0,_asyncToGenerator2.default)(function*(){yield new _api.PackageJsonEditor().extend({scripts:{"build:reason":"bsb -make-world -clean-world","watch:reason":"npm run build:reason -- -w"}}).commit()});return function task(){return _ref2.apply(this,arguments)}}(),condition:()=>(0,_api.allDoExist)("package.json")},{text:"Copy ReasonReact boilerplate files",task:function(){var _ref3=(0,_asyncToGenerator2.default)(function*({overwrite,sourceDirectory}){yield new _api.Scaffolder((0,_path.join)(__dirname,"templates")).overwrite(overwrite).target(`${sourceDirectory}/components`).copy("App.re").copy("Example.re").commit()});return function task(){return _ref3.apply(this,arguments)}}(),condition:({useReact})=>useReact,optional:({useReact})=>useReact},{text:"Install ReasonReact dependencies",task:function(){var _ref4=(0,_asyncToGenerator2.default)(function*({skipInstall}){yield(0,_api.install)(DEPENDENCIES,{skipInstall}),yield(0,_api.install)(DEV_DEPENDENCIES,{dev:!0,skipInstall})});return function task(){return _ref4.apply(this,arguments)}}(),condition:({skipInstall})=>!skipInstall&&(0,_api.allDoExist)("package.json")}];exports.addReason=addReason;const removeReason=[{text:"Delete bsconfig.json file",task:function(){var _ref5=(0,_asyncToGenerator2.default)(function*(){yield new _api.BsConfigJsonEditor().delete().commit()});return function task(){return _ref5.apply(this,arguments)}}(),condition:()=>(0,_api.allDoExist)("bsconfig.json")},{text:"Remove Reason scripts from package.json",task:function(){var _ref6=(0,_asyncToGenerator2.default)(function*(){yield new _api.PackageJsonEditor().extend({scripts:{"build:reason":void 0,"watch:reason":void 0}}).commit()});return function task(){return _ref6.apply(this,arguments)}}(),condition:()=>(0,_api.allDoExist)("package.json")},{text:"Uninstall Reason dependencies",task:()=>(0,_api.uninstall)([...DEPENDENCIES,...DEV_DEPENDENCIES]),condition:({skipInstall})=>!skipInstall&&(0,_api.allDoExist)("package.json")&&new _api.PackageJsonEditor().hasAll(...DEPENDENCIES,...DEV_DEPENDENCIES)// eslint-disable-line max-len
}];exports.removeReason=removeReason;var _default=addReason;exports.default=_default;